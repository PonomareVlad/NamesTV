<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Names TV based GSlides</title>
    <style>
        body {
            background: #212121;
        }

        body img {
            height: 100vh;
            width: 100vw;
            position: fixed;
            left: 0;
            top: 0;
            object-fit: contain;
            opacity: 0;
        }

    </style>
    <script>

        function runSlideShow() {
            const slides = document.querySelectorAll('body>img');
            const slidesCount = slides.length;
            let currentSlide = -1;
            let nextSlide = 0;
            setInterval(() => {
                nextSlide = slides[currentSlide + 1] ? (currentSlide + 1) : 0;
                if (slides[nextSlide]) slides[nextSlide].style.setProperty('opacity', 1);
                if (slides[currentSlide]) slides[currentSlide].style.setProperty('opacity', 0);
                currentSlide = nextSlide;
            }, 15000)
        }

        function loadImage(src, i) {
            return new Promise((resolve, reject) => {
                const img = document.createElement('img');
                img.onload = () => resolve(true);
                // img.style.setProperty('--i', i);
                img.src = src;
                document.body.appendChild(img);
            })
        }

        async function init() {

            const slides = await fetch('https://script.google.com/macros/s/AKfycbxOt0XDe9im0w1RYcWl-xs3QnVhw0K9Zwr9-kXDif_t1hTO7MF8/exec', {mode: 'cors'})
                .then(r => r.json());

            for await (const slide of slides) {
                await loadImage(slide, slides.indexOf(slide) + 1);
            }

            runSlideShow();

        }

        init();

    </script>
</head>
<body>
</body>
</html>